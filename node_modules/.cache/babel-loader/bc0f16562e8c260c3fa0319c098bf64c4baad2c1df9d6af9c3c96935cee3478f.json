{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gomcoder_mac/Desktop/Study/React/nwitter/nwitter/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/gomcoder_mac/Desktop/Study/React/nwitter/nwitter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/gomcoder_mac/Desktop/Study/React/nwitter/nwitter/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import{dbService,storageService}from\"fbase\";import{v4 as uuidv4}from\"uuid\";import Nweet from\"components/Nweet\";import Home from\"routes/Home\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NweetFactory=function NweetFactory(_ref){var userObj=_ref.userObj;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),nweet=_useState2[0],setNweet=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),attachment=_useState4[0],setAttachment=_useState4[1];var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var attachmentUrl,attachmentRef,reponse,nweetObj;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();attachmentUrl=\"\";if(!(attachment!==\"\")){_context.next=10;break;}attachmentRef=storageService.ref().child(\"\".concat(userObj.uid,\"/\").concat(uuidv4()));_context.next=6;return attachmentRef.putString(attachment,\"data_url\");case 6:reponse=_context.sent;_context.next=9;return reponse.ref.getDownloadURL();case 9:attachmentUrl=_context.sent;case 10:nweetObj={text:nweet,createdAt:Date.now(),creatorId:userObj.uid,attachmentUrl:attachmentUrl};_context.next=13;return dbService.collection(\"nweets\").add(nweetObj);case 13:setNweet(\"\");setAttachment(\"\");case 15:case\"end\":return _context.stop();}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();var onChange=function onChange(event){event.preventDefault();var value=event.target.value;setNweet(value);};var onFileChange=function onFileChange(event){var files=event.target.files;var theFile=files[0];var reader=new FileReader();reader.onloadend=function(finishedEvent){var result=finishedEvent.currentTarget.result;setAttachment(result);};reader.readAsDataURL(theFile);};var onClearAttachment=function onClearAttachment(){return setAttachment(\"\");};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"input\",{value:nweet,onChange:onChange,type:\"text\",placeholder:\"What's on your mind?\",maxLength:120}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:onFileChange}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Nweet\"}),attachment&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:attachment,width:\"50px\",height:\"50px\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClearAttachment,children:\" Clear \"})]})]});};export default NweetFactory;","map":{"version":3,"names":["useState","useEffect","dbService","storageService","v4","uuidv4","Nweet","Home","jsx","_jsx","jsxs","_jsxs","NweetFactory","_ref","userObj","_useState","_useState2","_slicedToArray","nweet","setNweet","_useState3","_useState4","attachment","setAttachment","onSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","attachmentUrl","attachmentRef","reponse","nweetObj","wrap","_callee$","_context","prev","next","preventDefault","ref","child","concat","uid","putString","sent","getDownloadURL","text","createdAt","Date","now","creatorId","collection","add","stop","_x","apply","arguments","onChange","value","target","onFileChange","files","theFile","reader","FileReader","onloadend","finishedEvent","result","currentTarget","readAsDataURL","onClearAttachment","children","type","placeholder","maxLength","accept","src","width","height","onClick"],"sources":["/Users/gomcoder_mac/Desktop/Study/React/nwitter/nwitter/src/components/NweetFactory.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { dbService, storageService } from \"fbase\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport Nweet from \"components/Nweet\";\nimport Home from \"routes/Home\";\n\nconst NweetFactory = ({userObj}) => {    \n    const [nweet, setNweet] = useState(\"\");\n    const [attachment, setAttachment] = useState(\"\");    \n    const onSubmit = async (event) => {\n        event.preventDefault();\n        let attachmentUrl = \"\";\n\n        if(attachment !== \"\") {\n            const attachmentRef = storageService\n            .ref()\n            .child(`${userObj.uid}/${uuidv4()}`);\n            const reponse = await attachmentRef.putString(attachment, \"data_url\");\n            attachmentUrl = await reponse.ref.getDownloadURL();\n        }\n\n        const nweetObj = {\n            text: nweet,\n            createdAt: Date.now(),\n            creatorId: userObj.uid,\n            attachmentUrl,\n        }\n\n\n        await dbService.collection(\"nweets\").add(nweetObj);\n        setNweet(\"\");\n        setAttachment(\"\");\n    };\n\n    const onChange = (event) => {\n        event.preventDefault();\n\n        const {\n            target: {value},\n        } = event;\n        setNweet(value);\n    };\n\n    const onFileChange = (event) => {\n        const {\n            target: {files},\n        } = event;\n        const theFile = files[0];\n        const reader = new FileReader();\n        reader.onloadend = (finishedEvent) => {\n            const {\n                currentTarget: {result},\n            } = finishedEvent;\n            setAttachment(result);\n        }\n        reader.readAsDataURL(theFile);\n    };\n\n    const onClearAttachment = () => setAttachment(\"\");\n\n    return (\n        <form onSubmit={onSubmit}>\n                <input\n                    value={nweet}\n                    onChange={onChange}\n                    type=\"text\"\n                    placeholder=\"What's on your mind?\"\n                    maxLength={120}\n                />\n                <input type=\"file\" accept=\"image/*\" onChange={onFileChange}/>\n                <input type=\"submit\" value=\"Nweet\"/>\n                {attachment && (\n                    <div>\n                        <img src={attachment} width=\"50px\" height=\"50px\" />\n                        <button onClick={onClearAttachment}> Clear </button>\n                    </div>\n                )}\n        </form>\n    );\n};\n\nexport default NweetFactory;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}